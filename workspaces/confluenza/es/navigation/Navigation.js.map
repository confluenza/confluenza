{"version":3,"sources":["../../source/navigation/Navigation.js"],"names":["React","TopLevelNavigationItem","NavigationItem","List","Navigation","props","config","state","reduce","acc","c","tag","console","log","window","restoredState","readNavigationState","clearNavigationState","navigationGroups","map","title","createNavigationGroupForTag","stateJSON","localStorage","getItem","validNavigationState","clear","JSON","parse","restoredStateKeys","Object","keys","currentStateKeys","every","e","includes","undefined","docs","filter","d","node","frontmatter","deltas","length","val","filtered","path","location","pathname","replace","index","setState","top","addedContentHeight","navigationElementTotalHeight","clientHeight","scrollerRef","current","requiredHeight","currentHeight","scrollTop","scrollAmount","setTimeout","requiredScroll","calculateRequiredScroll","scrollBy","el","Number","RegExp","exec","getComputedStyle","height","delta","element","triggerElement","getElementHeight","updateScrollPosition","offsetTop","updateDeltas","group","topLevelNavigationItemChanged","isActive","aggregateDeltas","doc","i","midLevelNavigationItemChanged","clearTimeout","scrollTimer","Math","max","min","scrollHeight","createRef","confluenzaConfig","initializaNavigationState","restoreNavigationState","createNavigationGroups","setItem","stringify","onScroll","overflowY","position","WebkitOverflowScrolling","width","background","g","renderNavigationGroup","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled from '@emotion/styled'\n\nimport { TopLevelNavigationItem } from './top-level-navigation-item'\nimport { NavigationItem } from './NavigationItem'\n\nconst List = styled.ul({\n  listStyle: 'none',\n  paddingTop: '0.5rem',\n  paddingBottom: 0,\n  margin: 0\n})\n\nexport class Navigation extends React.PureComponent {\n  navigationGroups\n\n  constructor (props) {\n    super(props)\n\n    this.scrollerRef = React.createRef()\n\n    const { confluenzaConfig } = this.props\n\n    this.initializaNavigationState(confluenzaConfig)\n\n    this.restoreNavigationState()\n\n    this.createNavigationGroups(confluenzaConfig)\n  }\n\n  initializaNavigationState = config => {\n    this.state = config.reduce((acc, c) => {\n      acc[`${c.tag}Deltas`] = []\n      return acc\n    }, {})\n    console.log('STATE=', this.state)\n  }\n\n  restoreNavigationState = () => {\n    if (typeof window !== 'undefined') {\n      const restoredState = this.readNavigationState()\n      if (restoredState) {\n        console.log('Restoring navigation state')\n        // eslint-disable-next-line\n        this.state = restoredState\n      } else {\n        console.log('[New Site!]: clearing persisted navigation state')\n        this.clearNavigationState()\n      }\n    }\n  }\n\n  createNavigationGroups = config => {\n    this.navigationGroups = config.map(c => {\n      const { title, tag } = c\n      return this.createNavigationGroupForTag({\n        title,\n        tag\n      })\n    })\n  }\n\n  readNavigationState = () => {\n    const stateJSON = window.localStorage.getItem('navigation')\n    return this.validNavigationState(stateJSON)\n  }\n\n  clearNavigationState = () => {\n    window.localStorage.clear()\n  }\n\n  validNavigationState = stateJSON => {\n    if (stateJSON) {\n      const restoredState = JSON.parse(stateJSON)\n      const restoredStateKeys = Object.keys(restoredState)\n      const currentStateKeys = Object.keys(this.state)\n      if (currentStateKeys.every(e => restoredStateKeys.includes(e))) {\n        return restoredState\n      }\n    }\n    return undefined\n  }\n\n  createNavigationGroupForTag = ({ title, tag }) => {\n    return {\n      title,\n      docs: this.props.docs.filter(d => d.node.frontmatter.tag === tag),\n      tag\n    }\n  }\n\n  aggregateDeltas = deltas => {\n    if (deltas.length > 0) {\n      return deltas.reduce((acc, val) => acc + val)\n    }\n    return 0\n  }\n\n  isActive = docs => {\n    if (docs && docs.length > 0) {\n      const filtered = docs.filter(d => d.node.frontmatter.path === this.props.location.pathname.replace(/\\/$/, ''))\n      return filtered.length > 0\n    }\n    return false\n  }\n\n  updateDeltas = (tag, index, d) => {\n    let deltas = [...this.state[`${tag}Deltas`]]\n    deltas[index] = d\n    deltas = [...deltas].map(d => {\n      if (d === undefined) {\n        return 0\n      }\n      return d\n    })\n    this.setState({ [`${tag}Deltas`]: deltas })\n  }\n\n  calculateRequiredScroll = ({ top, addedContentHeight, navigationElementTotalHeight }) => {\n    const clientHeight = this.scrollerRef.current.clientHeight\n    const requiredHeight = top + navigationElementTotalHeight + addedContentHeight\n    const currentHeight = clientHeight + this.scrollerRef.current.scrollTop\n    return requiredHeight - currentHeight\n  }\n\n  scrollBy = scrollAmount => {\n    this.scrollerRef.current.scrollTop += scrollAmount\n  }\n\n  updateScrollPosition = ({ top, addedContentHeight, navigationElementTotalHeight }) => {\n    if (addedContentHeight > 0 && this.scrollerRef.current) {\n      setTimeout(() => {\n        const requiredScroll = this.calculateRequiredScroll({\n          top,\n          addedContentHeight,\n          navigationElementTotalHeight\n        })\n        if (requiredScroll > 0) {\n          this.scrollBy(requiredScroll)\n        }\n      }, 500)\n    }\n  }\n\n  getElementHeight = el => {\n    if (typeof window !== 'undefined') {\n      return Number(RegExp(/\\d+/).exec(window.getComputedStyle(el).height)[0])\n    }\n    return 0\n  }\n\n  topLevelNavigationItemChanged = (delta, element, triggerElement) => {\n    const navigationElementTotalHeight = this.getElementHeight(triggerElement)\n    this.updateScrollPosition({\n      top: element.offsetTop,\n      addedContentHeight: delta,\n      navigationElementTotalHeight\n    })\n  }\n\n  midLevelNavigationItemChanged = (tag, index, delta, element, triggerElement) => {\n    this.updateDeltas(tag, index, delta)\n\n    const navigationElementTotalHeight = this.getElementHeight(triggerElement)\n\n    this.updateScrollPosition({\n      top: element.offsetTop,\n      addedContentHeight: delta,\n      navigationElementTotalHeight\n    })\n  }\n\n  renderNavigationGroup = group => (\n    <TopLevelNavigationItem\n      key={group.tag}\n      tag={group.tag}\n      title={group.title}\n      onChange={(delta, el, triggerElement) => this.topLevelNavigationItemChanged(delta, el, triggerElement)}\n      active={this.isActive(group.docs)}\n      delta={this.aggregateDeltas(this.state[`${group.tag}Deltas`])}>\n      <div>\n        <List>\n          {\n            group.docs.map((doc, i) => (\n              <NavigationItem\n                key={i}\n                location={this.props.location}\n                {...doc}\n                onChange={(delta, el, triggerElement) =>\n                  this.midLevelNavigationItemChanged(group.tag, i, delta, el, triggerElement)\n                } />\n            ))\n          }\n        </List>\n      </div>\n    </TopLevelNavigationItem>\n  )\n\n  componentDidMount () {\n    this.scrollerRef.current.scrollTop = Math.max(1, Math.min(this.scrollerRef.current.scrollTop, this.scrollerRef.current.scrollHeight - this.scrollerRef.current.clientHeight - 1))\n  }\n\n  componentDidUpdate () {\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem('navigation', JSON.stringify(this.state))\n    }\n  }\n\n  // This is insane, but seem to do miracles on iOS: https://stackoverflow.com/a/51998690/1272679\n  onScroll = e => {\n    clearTimeout(this.scrollTimer)\n    this.scrollTimer = setTimeout(() => {\n      if (this.scrollerRef.current) {\n        this.scrollerRef.current.scrollTop = Math.max(1, Math.min(this.scrollerRef.current.scrollTop, this.scrollerRef.current.scrollHeight - this.scrollerRef.current.clientHeight - 1))\n      }\n    }, 200)\n  }\n\n  render () {\n    return (\n      <div onScroll={this.onScroll} ref={this.scrollerRef} css={{\n        overflowY: 'auto',\n        position: 'relative',\n        height: 'calc(100% - 20px - 2rem - 1.8rem - 98px)',\n        '@media (orientation: landscape)': {\n          height: 'calc(100% - 20px - 2rem - 1.8rem - 70px)'\n        },\n        WebkitOverflowScrolling: `touch`,\n        '::-webkit-scrollbar': {\n          width: `6px`,\n          height: `6px`\n        },\n        '::-webkit-scrollbar-thumb': {\n          background: '#ccc'\n        }\n      }}>\n        { this.navigationGroups.map(g => this.renderNavigationGroup(g))}\n      </div>\n    )\n  }\n}\n"],"file":"Navigation.js"}